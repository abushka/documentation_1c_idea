# documentation_1c_idea

Первоначально нужно поправить грамматические ошибки


Вот ошибки здорового человека

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/0bcf460d-7a5f-4d5d-be7e-f82f10f72130)

Но не у нас, у нас их намного больше

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/c8185a89-6b6d-4926-9652-fff152007b47)


Ошибки делятся на 6 типов

1 - Ошибки конфигурации (~172)

2 - Блокирующие (~101)

3 - Критические (~219)

4 - Значительные (~963)

5 - Незначительные (~3361)

6 - Тривиальные (~404)


Наиболее важная проблема - почти во всех справочниках, документах, отчётах, есть циклы где происходит запрос к базе данных, нельзя в цикле обращаться к базе данных, это является ошибкой типа "*Критическая*", вот несколько примеров

# Запросы в циклах

Выполнение запроса к базе в цикле вызывает такие проблемы как:

- медленная производительность
- проблемы с масштабированием
- проблемы с безопасностью

Если цикл выполняет много запросов в секунду, это может оказаться нагрузкой на сервер или базу данных. В таком случае, можно рассмотреть оптимизацию запросов, например, пакетное выполнение.

Если приложение рассчитано на обработку большого числа пользователей или данных, циклические запросы могут стать узким местом. Рассмотрите использование кэширования, оптимизированных запросов и других техник для обеспечения масштабируемости.

Циклические запросы по сети могут привести к дополнительным задержкам. Если возможно, рассмотрите асинхронные операции или минимизацию числа запросов.

Если в цикле выполняются запросы с данными, полученными от пользователя, это может создать уязвимости, такие как инъекции.

Каждый программист-инженер знает, что если запрос выполняется в цикле, то это не код, а лапша.

1. Цикл содержит выполнение запроса и отсутствует обязательная проверка признака ОбменДанными.Загрузка в обработчике события "ПередЗаписью" (Ошибка типа "Значительные")

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/7d9c0dd0-c127-4f42-950b-3c1e4bcfd901)


2. Цикл содержит выполнение запроса, в данном файле в 8 местах наблюдается данная проблема

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/cf6a2db3-92b8-453d-8ded-0cbae0fad9c0)


3. Цикл содержит вызов метода с запросом "ПолучитьБонус() (тип ошибки "Критический")

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/c2a10e57-fcee-4349-9096-379b3948d40c)


4. Цикл содержит вызов метода с запросом "получитьцена()", "получитьцена11()", "ПолучитьНовыйЦена()", также в файле есть выполнение запроса в цикле в нескольких местах

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/498fa39d-64d6-40bb-a508-3378602ce781)


5. 1С видит данную строку как критичискую ошибку и таких ошибок в документе 4

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/bff22d34-7806-44ba-a1f0-3f30d4620cf8)


ну и конечно вишенка на торте :)

6. В этом файле 170 выполнений запросов к базе в циклах, также почти все критические ошибки касаются именно выполнения запросов в циклах

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/c239835d-8bfe-48ec-b26e-72d3c8306343)

7. В этом файле 180 выполнений запросов к базе в циклах

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/5abfb852-ff2f-4e98-a002-dbd9bc904ca6)


# Значительные ошибки

Очень часто встречаются ошибки где указан некорректный путь

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/8718b885-cc7f-487c-8e74-6a77d2f56155)


У полей "ссылка", таблиц динамического списков, не отключена пользовательская видимость

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/e86d43e8-d23b-41e2-8a9d-28cd5578d8da)

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/d0e31d16-378f-4f7a-9ec4-f46d5c8472fa)


Это решается в несколько кликов

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/6c85aedb-7684-4e99-b296-a2dd60c7e4f4)



# Лапша код

8. Слишком много циклов, тройной вложенный Цикл -> Цикл -> Цикл ->
 
![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/5a8ff027-a34d-4cba-b17d-440f6141ba55)

Также в приходной накладной тройной вложенный Цикл -> Цикл -> Цикл ->

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/32dfb1de-6ac6-4a0c-9a2b-16859096a091)


9. В общем модуле "ТелеграмСервер" -> Модуль есть простейшая на вид проверка на тип файла

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/9a75c4c2-d09a-4120-9da3-d7e829afbb20)

этот же код можно написать более легче, а именно:

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/3f61b551-67de-482e-8af8-7948d7316f71)

10. Так ни в коем случае нельзя делать, никогда!!!

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/dc6ee873-f077-4661-9b81-9d7e0d7e9c92)

намного легче создать list со всемии ключевыми словами и сделать одно условие

11. Просто ужасно написано, одни условия, выполнение запросов в цикле, неопределённые функции и это всё в РАСХОДНОЙ НАКЛАДНОЙ, она выполняется каждый день, две тысячи строк, пятьдесят филиалов.
 
![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/405673bf-d9e7-4317-8379-a5fd80394dfb)


12. Отсутствует обязательная проверка признака ОбменДанными.Загрузчика в обработчике события "ПередЗаписью" (Ошибка типа "Значительные")

![image](https://github.com/abushka/documentation_1c_idea/assets/65396568/7860729b-09aa-4cf5-bb2b-c99fce19b34a)


Откроется ещё 50 филиалов и потребуется новый сервер ? Намного легче просто переписать код и сервера который сейчас, хватит ещё лет на 10 как минимум, но если ничего не делать и оставить всё на произвол судьбы - максимум срок серваку полтора года-два. Сейчас добавляется новый отчёт/документы/обработка и серваку нужно улучшать характеристики. Серверу с такими характеристиками как у IDEA легко будет обслужить одновременно 10.000 пользователей, но при условии что код будет нормально написан, любой 1С-программист с пониманием инженерии в программировании сможет это сделать.
